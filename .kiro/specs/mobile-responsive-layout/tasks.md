# Implementation Plan

- [x] 1. Set up testing infrastructure and responsive utilities
  - [x] 1.1 Install testing dependencies (vitest, @testing-library/react, fast-check)
    - Add vitest, @testing-library/react, @testing-library/jest-dom, fast-check to devDependencies
    - Configure vitest.config.ts for React/Next.js
    - _Requirements: 7.2_
  - [x] 1.2 Create useMediaQuery hook
    - Implement hook that returns boolean based on media query match
    - Handle SSR by returning false when window is undefined
    - Add resize event listener with cleanup
    - _Requirements: 1.1, 1.4, 2.1, 2.4_
  - [ ]* 1.3 Write property tests for useMediaQuery hook
    - **Property 1: Mobile layout configuration** - verify hook returns correct value for viewport widths
    - **Validates: Requirements 1.1, 2.1, 6.1, 6.2, 6.3**

- [x] 2. Implement Drawer component
  - [x] 2.1 Create Drawer component with position prop
    - Implement slide-in animation from left or right based on position prop
    - Render backdrop when open
    - Apply scroll lock to body when open
    - Include ARIA attributes (role="dialog", aria-modal="true", aria-label)
    - _Requirements: 3.1, 3.2, 3.3, 3.6, 3.7_
  - [x] 2.2 Add close handlers to Drawer
    - Handle backdrop click to call onClose
    - Handle ESC key press to call onClose
    - Return focus to trigger element on close
    - _Requirements: 3.4, 3.5, 1.3, 2.3_
  - [ ]* 2.3 Write property tests for Drawer component
    - **Property 5: Drawer position behavior** - verify position prop controls slide direction
    - **Property 6: Drawer backdrop visibility** - verify backdrop renders when open
    - **Property 7: Drawer scroll lock** - verify body overflow is hidden when open
    - **Property 8: Drawer accessibility attributes** - verify ARIA attributes are present
    - **Validates: Requirements 3.1, 3.2, 3.3, 3.6, 3.7**
  - [ ]* 2.4 Write property tests for Drawer close mechanisms
    - **Property 4: Drawer close mechanisms** - verify backdrop click and ESC close drawer
    - **Validates: Requirements 1.3, 2.3, 3.4, 3.5**

- [x] 3. Implement MobileHeader component
  - [x] 3.1 Create MobileHeader with menu and AI buttons
    - Render menu button (hamburger icon) on left
    - Render logo in center
    - Render AI button on right
    - Accept onMenuClick and onAiClick handlers
    - Only visible on mobile (hidden md:hidden class pattern)
    - _Requirements: 6.1, 6.2, 6.3, 6.4_
  - [ ]* 3.2 Write unit tests for MobileHeader
    - Test buttons render correctly
    - Test click handlers are called
    - _Requirements: 6.1, 6.2_

- [x] 4. Implement AppShell component
  - [x] 4.1 Create AppShell with responsive layout logic
    - Manage isSidebarOpen and isAiOpen state
    - Use useMediaQuery to detect mobile/desktop
    - Render MobileHeader on mobile only
    - Render Sidebar inline on desktop, in left Drawer on mobile
    - Render AI Panel inline on desktop, in right Drawer on mobile
    - _Requirements: 5.1, 1.1, 1.4, 2.1, 2.4_
  - [x] 4.2 Implement main content responsive layout
    - Full width on mobile (no sidebar margin)
    - Three-column layout on desktop
    - Prevent horizontal overflow
    - _Requirements: 4.1, 4.2, 4.3, 4.4_
  - [ ]* 4.3 Write property tests for AppShell layout
    - **Property 1: Mobile layout configuration** - verify mobile hides sidebar/AI, shows header
    - **Property 2: Desktop layout configuration** - verify desktop shows sidebar/AI inline, hides header
    - **Property 9: Mobile content layout** - verify full width without inline panels
    - **Property 10: Desktop three-column layout** - verify three columns present
    - **Property 11: No horizontal overflow** - verify no overflow at any width
    - **Validates: Requirements 1.1, 1.4, 2.1, 2.4, 4.1, 4.2, 4.3, 4.4, 6.1-6.4**
  - [ ]* 4.4 Write property tests for AppShell drawer behavior
    - **Property 3: Drawer toggle behavior** - verify buttons open correct drawers
    - **Property 12: AppShell state management** - verify state controls drawer visibility
    - **Validates: Requirements 1.2, 2.2, 5.1**

- [ ] 5. Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

- [x] 6. Integrate AppShell into pages
  - [x] 6.1 Update home page (page.tsx) to use AppShell
    - Wrap content with AppShell component
    - Pass AIPanelCard as aiPanel prop
    - Remove inline Sidebar rendering
    - Remove inline AI panel rendering
    - Adjust main content styles for responsive layout
    - _Requirements: 4.1, 4.2, 4.3, 5.2_
  - [x] 6.2 Update job detail page to use AppShell
    - Wrap content with AppShell component
    - Pass JobDetailAIPanel as aiPanel prop
    - Remove inline Sidebar rendering
    - Remove inline AI panel rendering
    - Adjust main content styles for responsive layout
    - _Requirements: 4.1, 4.2, 4.3, 5.2_

- [ ] 7. Add semantic tokens for mobile layout
  - [ ] 7.1 Add mobile-specific tokens to globals.css
    - Add --spacing-mobile-header-height token
    - Add --spacing-drawer-width token if needed
    - Ensure all new values use semantic naming
    - _Requirements: 7.1, 7.3_

- [ ] 8. Final Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.
